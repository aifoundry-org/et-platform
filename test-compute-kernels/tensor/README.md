
Tensor Kernel
=============

Author: emizan

This test exercise tensor instructions on an FC scale. Still work in progress

Currently each minion is paired with another. The producer makes a tensor_store and the consumer make a tensor_load.
Afte the store the SC CB is flushed and to make sure no load starts beofre its producing store FCC synhronization is provided
between producer-consumer peirs.

The mappings and tensor store / load configurations are provide by file incliude/load_store_mappings.h
This should be generated by a script using a random seed, checking the script in is TBD.

To run this test in sys_emu, please do the following:

1. Change MasterMinion/main.c:

@@ -203,8 +203,8 @@ static void fake_message_from_host(void)
         const host_message_t host_message = {
             .message_id = MBOX_MESSAGE_ID_KERNEL_LAUNCH,
             .kernel_params = {
-                .tensor_a = 0,
-                .tensor_b = 0,
+                .tensor_a = 0x8180000000ULL,
+                .tensor_b = 0x10000000ULL,
                 .tensor_c = 0,
                 .tensor_d = 0,
                 .tensor_e = 0,
@@ -216,7 +216,7 @@ static void fake_message_from_host(void)
             .kernel_info = {
                 .compute_pc = KERNEL_UMODE_ENTRY,
                 .uber_kernel_nodes = 0, // unused
-                .shire_mask = 0x1, //0xFFFFFFFF
+                .shire_mask = 0xFFFFFFFF,
                 .kernel_params_ptr = NULL, // gets fixed up
                 .grid_config_ptr = NULL // TODO
             }

Then build with DEBUG_FAKE_MESSAGE_FROM_HOST enabled

2. After building copy data.raw and mem_desc.txt in the build directory.

3. Run with sys_emu:
sys_emu -master_min -mem_desc mem_desc.txt -shires 1ffffffff -minions ffffffff -l -lm 32 -max_cycles 1000000

Also TBD: Have this test be configrable to run on a single shire and FC.
This will help with testing and running on Zebu.
