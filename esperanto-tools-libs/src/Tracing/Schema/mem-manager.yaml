#------------------------------------------------------------------------------
# Copyright (C) 2019, Esperanto Technologies Inc.
# The copyright to the computer program(s) herein is the
# property of Esperanto Technologies, Inc. All Rights Reserved.
# The program(s) may be used and/or copied only with
# the written permission of Esperanto Technologies and
# in accordance with the terms and conditions stipulated in the
# agreement/contract under which the program(s) have been supplied.
#------------------------------------------------------------------------------

Name: MemoryManager
EnablePBLogging : True
EnableTextLogging: True
DefaultON : True
Functions :
  - Name: malloc
    Type: ObjectCreate
    Description: Object created when a malloc call is called and we record the allocated memory pointer
    EnablePBLogging : True
    EnableTextLogging: True
    DefaultON : True
    Arguments:
      - Name: size
        Input : True
        Type : uint64
        Required : True
        Deprecated: False
      - Name: allocated_pointer
        Output : True
        Type: uint64
        Required: True
        Deprecated: False
  - Name: free
    Type: ObjectDestroy
    Description: Object destroyed, deallocate a tesnor on the device
    EnablePBLogging : True
    EnableTextLogging: True
    DefaultON : True
    Arguments:
      - Name: pointer
        Output : True
        Type: uint64
        Required: True
        Deprecated: False
########### Linear Allocator ##################
  - Name: LinearAllocator_Constructor
    Description: Constructor of the Linear Allocator
    Type: ObjectCreate
    EnablePBLogging : True
    EnableTextLogging: True
    DefaultON : True
    Arguments:
      - Name: device_id
        Type: int32
      - Name: base
        Type: uint64
      - Name: size
        Type: uint64
  - Name: LinearAllocator_malloc
    Description: Malloc of a Linear Allocator
    Type: ObjectCreate
    Arguments:
      - Name: device_id
        Type: int32
      - Name: type
        Type: int32
      - Name: tensor_id
        Type: int64
      - Name: base
        Type: int64
      - Name: md_size
        Type: int32
      - Name: size
        Type: int64
      - Name: left_tensor
        Type: int64
      - Name: right_tensor
        Type: int64
  - Name: LinearAllocator_free
    Description: Free of a Linear Allocator
    Type: ObjectDestroy
    Arguments:
      - Name: device_id
        Type: int32
      - Name: tensor_id
        Type: int64
  - Name: LinearAllocator_jsonStatus
    Description: Construct a JSON string with snapshot of the allocator in JSON Format
    Type: Snapshot
    Arguments:
      - Name: state
        Type: string
########### Bidirectional Allocator ##################
  - Name: BidirectionalAllocator_Constructor
    Description: Constructor of the Bidirectional Allocator
    Type: ObjectCreate
    EnablePBLogging : True
    EnableTextLogging: True
    DefaultON : True
    Arguments:
      - Name: device_id
        Type: int32
      - Name: base
        Type: uint64
      - Name: size
        Type: uint64
  - Name: BidirectionalAllocator_mallocFront
    Description: Malloc at the front of a Bidirectional Allocator
    Type: ObjectCreate
    Arguments:
      - Name: device_id
        Type: int32
      - Name: type
        Type: int32
      - Name: tensor_id
        Type: int64
      - Name: base
        Type: int64
      - Name: md_size
        Type: int32
      - Name: size
        Type: int64
      - Name: left_tensor
        Type: int64
      - Name: right_tensor
        Type: int64
  - Name: BidirectionalAllocator_mallocBack
    Description: Malloc at the back of a Bidirectional Allocator
    Type: ObjectCreate
    Arguments:
      - Name: device_id
        Type: int32
      - Name: type
        Type: int32
      - Name: tensor_id
        Type: int64
      - Name: base
        Type: int64
      - Name: md_size
        Type: int32
      - Name: size
        Type: int64
      - Name: left_tensor
        Type: int64
      - Name: right_tensor
        Type: int64
  - Name: BidirectionalAllocator_free
    Description: Free of a Bidirectional Allocator
    Type: ObjectDestroy
    Arguments:
      - Name: device_id
        Type: int32
      - Name: tensor_id
        Type: int64
  - Name: BidirectionalAllocator_jsonStatus
    Description: Construct a JSON string with snapshot of the allocator in JSON Format
    Type: Snapshot
    Arguments:
      - Name: state
        Type: string
########### Memory Manager Internals ##################
  - Name: MemoryManagerInternals_mallocCode
    Description: Allocate a code buffer
    Type: Snapshot
    Arguments:
      - Name: size
        Type: int64
  - Name: MemoryManagerInternals_mallocConstant
    Description: Allocate a Constant buffer
    Type: Snapshot
    Arguments:
      - Name: size
        Type: int64
  - Name: MemoryManagerInternals_mallocPlaceholder
    Description: Allocate a Placeholder buffer
    Type: Snapshot
    Arguments:
      - Name: size
        Type: int64
  - Name: MemoryManagerInternals_freeCode
    Description: Deallocate a Constant buffer
    Type: Snapshot
    Arguments:
      - Name: tensor_id
        Type: int64
  - Name: MemoryManagerInternals_freeData
    Description: Deallocate tensor from the data region
    Type: Snapshot
    Arguments:
      - Name: tensor_id
        Type: int64
