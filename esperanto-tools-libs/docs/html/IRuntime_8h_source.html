<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Host Runtime: /home/dredok/sw-platform/host-software/esperanto-tools-libs/include/runtime/IRuntime.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Host Runtime
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_2eab888c937f3427b184259251c0a7e9.html">runtime</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">IRuntime.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2020, Esperanto Technologies Inc.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * The copyright to the computer program(s) herein is the</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * property of Esperanto Technologies, Inc. All Rights Reserved.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * The program(s) may be used and/or copied only with</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the written permission of Esperanto Technologies and</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * in accordance with the terms and conditions stipulated in the</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * agreement/contract under which the program(s) have been supplied.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *-------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;IProfiler.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;Types.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;ostream&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// forward declarations</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">namespace </span>dev {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">class </span>IDeviceLayer;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">namespace </span>rt {</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classrt_1_1IRuntime.html">   40</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrt_1_1IRuntime.html">IRuntime</a> {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  std::vector&lt;DeviceId&gt; <a class="code" href="classrt_1_1IRuntime.html#a0ccd044349fb81c6c94eafa28b977c95">getDevices</a>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="structrt_1_1DeviceProperties.html">DeviceProperties</a> <a class="code" href="classrt_1_1IRuntime.html#a44e1ef24b9d683cc0a51ef250fb8123e">getDeviceProperties</a>(DeviceId device) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  std::byte* <a class="code" href="classrt_1_1IRuntime.html#a40cded710ad5ed5b69107b2a72fadb2e">mallocDevice</a>(DeviceId device, <span class="keywordtype">size_t</span> size, uint32_t alignment = kCacheLineSize);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classrt_1_1IRuntime.html#a114f89ceff8d1154d389404c6ec57f39">freeDevice</a>(DeviceId device, std::byte* buffer);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  StreamId <a class="code" href="classrt_1_1IRuntime.html#a0e3a36b976e629594a7ba6e82817505b">createStream</a>(DeviceId device);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classrt_1_1IRuntime.html#ab5356f8b2d41f61c4d76706ec9704ee4">destroyStream</a>(StreamId stream);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="structrt_1_1LoadCodeResult.html">LoadCodeResult</a> <a class="code" href="classrt_1_1IRuntime.html#a3091bd0f4aa2efa99c93da9ea186226b">loadCode</a>(StreamId stream, <span class="keyword">const</span> std::byte* elf, <span class="keywordtype">size_t</span> elf_size);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classrt_1_1IRuntime.html#a160e7929d069773d59940e8b9e50dce6">unloadCode</a>(KernelId kernel);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  EventId <a class="code" href="classrt_1_1IRuntime.html#a5e95aab372520fc3d5e0de092562452f">kernelLaunch</a>(StreamId stream, KernelId kernel, <span class="keyword">const</span> std::byte* kernel_args, <span class="keywordtype">size_t</span> kernel_args_size,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                       uint64_t shire_mask, <span class="keywordtype">bool</span> barrier = <span class="keyword">true</span>, <span class="keywordtype">bool</span> flushL3 = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                       std::optional&lt;UserTrace&gt; userTraceConfig = std::nullopt);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  EventId <a class="code" href="classrt_1_1IRuntime.html#a7501a6f2e7959b283fd801ac6aeb0f8b">memcpyHostToDevice</a>(StreamId stream, <span class="keyword">const</span> std::byte* h_src, std::byte* d_dst, <span class="keywordtype">size_t</span> size,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                             <span class="keywordtype">bool</span> barrier = <span class="keyword">false</span>, <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction = defaultCmaCopyFunction);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  EventId <a class="code" href="classrt_1_1IRuntime.html#a5f1038d3f71b63a7bd0d6f66c10647ff">memcpyDeviceToHost</a>(StreamId stream, <span class="keyword">const</span> std::byte* d_src, std::byte* h_dst, <span class="keywordtype">size_t</span> size,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                             <span class="keywordtype">bool</span> barrier = <span class="keyword">true</span>, <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction = defaultCmaCopyFunction);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  EventId <a class="code" href="classrt_1_1IRuntime.html#a7501a6f2e7959b283fd801ac6aeb0f8b">memcpyHostToDevice</a>(StreamId stream, <a class="code" href="structrt_1_1MemcpyList.html">MemcpyList</a> memcpyList, <span class="keywordtype">bool</span> barrier = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                             <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction = defaultCmaCopyFunction);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  EventId <a class="code" href="classrt_1_1IRuntime.html#a5f1038d3f71b63a7bd0d6f66c10647ff">memcpyDeviceToHost</a>(StreamId stream, <a class="code" href="structrt_1_1MemcpyList.html">MemcpyList</a> memcpyList, <span class="keywordtype">bool</span> barrier = <span class="keyword">true</span>,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                             <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction = defaultCmaCopyFunction);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrt_1_1IRuntime.html#a51538d6474b88062aba71ff8d8c959a2">waitForEvent</a>(EventId event, std::chrono::seconds timeout = std::chrono::hours(24));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrt_1_1IRuntime.html#a83b06e67256ef740f73b2019f78974f1">waitForStream</a>(StreamId stream, std::chrono::seconds timeout = std::chrono::hours(24));</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  std::vector&lt;StreamError&gt; <a class="code" href="classrt_1_1IRuntime.html#a25b55dad27d716b53901b35399040ff8">retrieveStreamErrors</a>(StreamId stream);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classrt_1_1IRuntime.html#ae7d60310e5fc9b7807a964cbbaf50a2a">setOnKernelAbortedErrorCallback</a>(<span class="keyword">const</span> KernelAbortedCallback&amp; callback);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classrt_1_1IRuntime.html#af5041e57ed0f533a32b1d12fa1bcf15d">setOnStreamErrorsCallback</a>(StreamErrorCallback callback);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classrt_1_1IRuntime.html#aea977b0f35ff1a0e7d43b7cf5dc1303b">  269</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classrt_1_1IRuntime.html#aea977b0f35ff1a0e7d43b7cf5dc1303b">setProfiler</a>(std::unique_ptr&lt;profiling::IProfilerRecorder&gt; profiler) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    profiler_ = std::move(profiler);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    onProfilerChanged();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classrt_1_1IRuntime.html#a145044ba3d9ed62b320a296b0e1f143c">  279</a></span>&#160;  <a class="code" href="classrt_1_1profiling_1_1IProfilerRecorder.html">profiling::IProfilerRecorder</a>* <a class="code" href="classrt_1_1IRuntime.html#a145044ba3d9ed62b320a296b0e1f143c">getProfiler</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">return</span> profiler_.get();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  EventId <a class="code" href="classrt_1_1IRuntime.html#a7cee724ef99f41ffc5830851f7633237">abortCommand</a>(EventId commandId, std::chrono::milliseconds timeout = std::chrono::milliseconds(5000));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  EventId <a class="code" href="classrt_1_1IRuntime.html#aeb8243996204585371f98baedd98a9a2">abortStream</a>(StreamId streamId);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="structrt_1_1DmaInfo.html">DmaInfo</a> <a class="code" href="classrt_1_1IRuntime.html#ab16570e7e5c31f16be7b377b14ace61b">getDmaInfo</a>(DeviceId deviceId) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classrt_1_1IRuntime.html#ace5a0b9c8f1ffef2c946bf63c3323940">~IRuntime</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="classrt_1_1IRuntime.html#a32c12e62c1b46e2c1d6d899f8ca63969">IRuntime</a>();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keyword">static</span> RuntimePtr <a class="code" href="classrt_1_1IRuntime.html#a2026e8a4e067c85cb82a52d60c2f7872">create</a>(dev::IDeviceLayer* deviceLayer, <a class="code" href="structrt_1_1Options.html">Options</a> options = getDefaultOptions());</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keyword">static</span> RuntimePtr <a class="code" href="classrt_1_1IRuntime.html#a2026e8a4e067c85cb82a52d60c2f7872">create</a>(<span class="keyword">const</span> std::string&amp; socketPath);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  std::unique_ptr&lt;profiling::IProfilerRecorder&gt; profiler_;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// NVI applied, all public interface is non-virtual; customization is in the private part</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keyword">virtual</span> std::vector&lt;DeviceId&gt; doGetDevices() = 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="structrt_1_1DeviceProperties.html">DeviceProperties</a> doGetDeviceProperties(DeviceId device) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="structrt_1_1LoadCodeResult.html">LoadCodeResult</a> doLoadCode(StreamId stream, <span class="keyword">const</span> std::byte* elf, <span class="keywordtype">size_t</span> elf_size) = 0;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> doUnloadCode(KernelId kernel) = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keyword">virtual</span> std::byte* doMallocDevice(DeviceId device, <span class="keywordtype">size_t</span> size, uint32_t alignment = kCacheLineSize) = 0;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> doFreeDevice(DeviceId device, std::byte* buffer) = 0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keyword">virtual</span> StreamId doCreateStream(DeviceId device) = 0;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> doDestroyStream(StreamId stream) = 0;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">virtual</span> EventId doKernelLaunch(StreamId stream, KernelId kernel, <span class="keyword">const</span> std::byte* kernel_args,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                 <span class="keywordtype">size_t</span> kernel_args_size, uint64_t shire_mask, <span class="keywordtype">bool</span> barrier, <span class="keywordtype">bool</span> flushL3,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                 std::optional&lt;UserTrace&gt; userTraceConfig) = 0;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keyword">virtual</span> EventId doMemcpyHostToDevice(StreamId stream, <span class="keyword">const</span> std::byte* src, std::byte* dst, <span class="keywordtype">size_t</span> size, <span class="keywordtype">bool</span> barrier,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                       <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction) = 0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">virtual</span> EventId doMemcpyDeviceToHost(StreamId stream, <span class="keyword">const</span> std::byte* src, std::byte* dst, <span class="keywordtype">size_t</span> size, <span class="keywordtype">bool</span> barrier,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                       <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction) = 0;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keyword">virtual</span> EventId doMemcpyHostToDevice(StreamId stream, <a class="code" href="structrt_1_1MemcpyList.html">MemcpyList</a> memcpyList, <span class="keywordtype">bool</span> barrier,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                       <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction) = 0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keyword">virtual</span> EventId doMemcpyDeviceToHost(StreamId stream, <a class="code" href="structrt_1_1MemcpyList.html">MemcpyList</a> memcpyList, <span class="keywordtype">bool</span> barrier,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                       <span class="keyword">const</span> CmaCopyFunction&amp; cmaCopyFunction) = 0;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> doWaitForEvent(EventId event, std::chrono::seconds timeout = std::chrono::hours(24)) = 0;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> doWaitForStream(StreamId stream, std::chrono::seconds timeout = std::chrono::hours(24)) = 0;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">virtual</span> EventId doAbortCommand(EventId commandId,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                 std::chrono::milliseconds timeout = std::chrono::milliseconds(5000)) = 0;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keyword">virtual</span> EventId doAbortStream(StreamId streamId) = 0;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> doSetOnStreamErrorsCallback(StreamErrorCallback callback) = 0;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> doSetOnKernelAbortedErrorCallback(<span class="keyword">const</span> KernelAbortedCallback&amp; callback) = 0;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keyword">virtual</span> std::vector&lt;StreamError&gt; doRetrieveStreamErrors(StreamId stream) = 0;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="structrt_1_1DmaInfo.html">DmaInfo</a> doGetDmaInfo(DeviceId deviceId) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onProfilerChanged(){<span class="comment">/* defaults do nothing */</span>};</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;};</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;} <span class="comment">// namespace rt</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span>  <span class="comment">// End of runtime_api</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassrt_1_1IRuntime_html_a25b55dad27d716b53901b35399040ff8"><div class="ttname"><a href="classrt_1_1IRuntime.html#a25b55dad27d716b53901b35399040ff8">rt::IRuntime::retrieveStreamErrors</a></div><div class="ttdeci">std::vector&lt; StreamError &gt; retrieveStreamErrors(StreamId stream)</div><div class="ttdoc">This will return a list of errors and their execution context (if any)</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_ae7d60310e5fc9b7807a964cbbaf50a2a"><div class="ttname"><a href="classrt_1_1IRuntime.html#ae7d60310e5fc9b7807a964cbbaf50a2a">rt::IRuntime::setOnKernelAbortedErrorCallback</a></div><div class="ttdeci">void setOnKernelAbortedErrorCallback(const KernelAbortedCallback &amp;callback)</div><div class="ttdoc">This callback (when set) will be automatically called when a kernel abort happens....</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html"><div class="ttname"><a href="classrt_1_1IRuntime.html">rt::IRuntime</a></div><div class="ttdoc">Facade Runtime interface declaration, all runtime interactions should be made using this interface....</div><div class="ttdef"><b>Definition:</b> IRuntime.h:40</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_aeb8243996204585371f98baedd98a9a2"><div class="ttname"><a href="classrt_1_1IRuntime.html#aeb8243996204585371f98baedd98a9a2">rt::IRuntime::abortStream</a></div><div class="ttdeci">EventId abortStream(StreamId streamId)</div><div class="ttdoc">Instructs the device to abort all outstanding commands on a given stream. This will affect to all com...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a40cded710ad5ed5b69107b2a72fadb2e"><div class="ttname"><a href="classrt_1_1IRuntime.html#a40cded710ad5ed5b69107b2a72fadb2e">rt::IRuntime::mallocDevice</a></div><div class="ttdeci">std::byte * mallocDevice(DeviceId device, size_t size, uint32_t alignment=kCacheLineSize)</div><div class="ttdoc">Allocates memory in the device, returns a device memory pointer. One can't use this pointer directly ...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a32c12e62c1b46e2c1d6d899f8ca63969"><div class="ttname"><a href="classrt_1_1IRuntime.html#a32c12e62c1b46e2c1d6d899f8ca63969">rt::IRuntime::IRuntime</a></div><div class="ttdeci">IRuntime()</div><div class="ttdoc">Constructor to initialize with a dummy profiler.</div></div>
<div class="ttc" id="astructrt_1_1DmaInfo_html"><div class="ttname"><a href="structrt_1_1DmaInfo.html">rt::DmaInfo</a></div><div class="ttdef"><b>Definition:</b> Types.h:244</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_aea977b0f35ff1a0e7d43b7cf5dc1303b"><div class="ttname"><a href="classrt_1_1IRuntime.html#aea977b0f35ff1a0e7d43b7cf5dc1303b">rt::IRuntime::setProfiler</a></div><div class="ttdeci">void setProfiler(std::unique_ptr&lt; profiling::IProfilerRecorder &gt; profiler)</div><div class="ttdoc">Sets a profiler to be used by runtime.</div><div class="ttdef"><b>Definition:</b> IRuntime.h:269</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a114f89ceff8d1154d389404c6ec57f39"><div class="ttname"><a href="classrt_1_1IRuntime.html#a114f89ceff8d1154d389404c6ec57f39">rt::IRuntime::freeDevice</a></div><div class="ttdeci">void freeDevice(DeviceId device, std::byte *buffer)</div><div class="ttdoc">Deallocates previously allocated memory on the given device.</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a2026e8a4e067c85cb82a52d60c2f7872"><div class="ttname"><a href="classrt_1_1IRuntime.html#a2026e8a4e067c85cb82a52d60c2f7872">rt::IRuntime::create</a></div><div class="ttdeci">static RuntimePtr create(dev::IDeviceLayer *deviceLayer, Options options=getDefaultOptions())</div><div class="ttdoc">Factory method to instantiate a standalone IRuntime implementation.</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a83b06e67256ef740f73b2019f78974f1"><div class="ttname"><a href="classrt_1_1IRuntime.html#a83b06e67256ef740f73b2019f78974f1">rt::IRuntime::waitForStream</a></div><div class="ttdeci">bool waitForStream(StreamId stream, std::chrono::seconds timeout=std::chrono::hours(24))</div><div class="ttdoc">This will block the caller thread until all commands issued to the given stream finish or if the time...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a7cee724ef99f41ffc5830851f7633237"><div class="ttname"><a href="classrt_1_1IRuntime.html#a7cee724ef99f41ffc5830851f7633237">rt::IRuntime::abortCommand</a></div><div class="ttdeci">EventId abortCommand(EventId commandId, std::chrono::milliseconds timeout=std::chrono::milliseconds(5000))</div><div class="ttdoc">Instructs the device to abort given command. NOTE: as per current firmware implementation,...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a0e3a36b976e629594a7ba6e82817505b"><div class="ttname"><a href="classrt_1_1IRuntime.html#a0e3a36b976e629594a7ba6e82817505b">rt::IRuntime::createStream</a></div><div class="ttdeci">StreamId createStream(DeviceId device)</div><div class="ttdoc">Creates a new stream and associates it to the given device. A stream is an abstraction of a &quot;pipeline...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_ab16570e7e5c31f16be7b377b14ace61b"><div class="ttname"><a href="classrt_1_1IRuntime.html#ab16570e7e5c31f16be7b377b14ace61b">rt::IRuntime::getDmaInfo</a></div><div class="ttdeci">DmaInfo getDmaInfo(DeviceId deviceId) const</div><div class="ttdoc">Returns the DmaInfo of given device (see DmaInfo). This DmaInfo contains max size for each operation ...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_af5041e57ed0f533a32b1d12fa1bcf15d"><div class="ttname"><a href="classrt_1_1IRuntime.html#af5041e57ed0f533a32b1d12fa1bcf15d">rt::IRuntime::setOnStreamErrorsCallback</a></div><div class="ttdeci">void setOnStreamErrorsCallback(StreamErrorCallback callback)</div><div class="ttdoc">This callback (when set) will be automatically called when a new StreamError occurs,...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a160e7929d069773d59940e8b9e50dce6"><div class="ttname"><a href="classrt_1_1IRuntime.html#a160e7929d069773d59940e8b9e50dce6">rt::IRuntime::unloadCode</a></div><div class="ttdeci">void unloadCode(KernelId kernel)</div><div class="ttdoc">Unloads a previously loaded elf code, identified by the kernel handler.</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_ab5356f8b2d41f61c4d76706ec9704ee4"><div class="ttname"><a href="classrt_1_1IRuntime.html#ab5356f8b2d41f61c4d76706ec9704ee4">rt::IRuntime::destroyStream</a></div><div class="ttdeci">void destroyStream(StreamId stream)</div><div class="ttdoc">Destroys a previously created stream.</div></div>
<div class="ttc" id="astructrt_1_1MemcpyList_html"><div class="ttname"><a href="structrt_1_1MemcpyList.html">rt::MemcpyList</a></div><div class="ttdoc">This struct will hold a number of memcpy operations.</div><div class="ttdef"><b>Definition:</b> Types.h:66</div></div>
<div class="ttc" id="astructrt_1_1LoadCodeResult_html"><div class="ttname"><a href="structrt_1_1LoadCodeResult.html">rt::LoadCodeResult</a></div><div class="ttdoc">This struct will contain the results of calling a loadCode function.</div><div class="ttdef"><b>Definition:</b> Types.h:203</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a44e1ef24b9d683cc0a51ef250fb8123e"><div class="ttname"><a href="classrt_1_1IRuntime.html#a44e1ef24b9d683cc0a51ef250fb8123e">rt::IRuntime::getDeviceProperties</a></div><div class="ttdeci">DeviceProperties getDeviceProperties(DeviceId device) const</div><div class="ttdoc">Returns the properties of a given device.</div></div>
<div class="ttc" id="astructrt_1_1Options_html"><div class="ttname"><a href="structrt_1_1Options.html">rt::Options</a></div><div class="ttdoc">This struct will hold parametrization options for Runtime instantiation.</div><div class="ttdef"><b>Definition:</b> Types.h:46</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_ace5a0b9c8f1ffef2c946bf63c3323940"><div class="ttname"><a href="classrt_1_1IRuntime.html#ace5a0b9c8f1ffef2c946bf63c3323940">rt::IRuntime::~IRuntime</a></div><div class="ttdeci">virtual ~IRuntime()=default</div><div class="ttdoc">Virtual Destructor to enable polymorphic release of the runtime instances.</div></div>
<div class="ttc" id="aclassrt_1_1profiling_1_1IProfilerRecorder_html"><div class="ttname"><a href="classrt_1_1profiling_1_1IProfilerRecorder.html">rt::profiling::IProfilerRecorder</a></div><div class="ttdoc">IProfilerRecorder interface declaration, its a simple added method to IProfiler interface for recordi...</div><div class="ttdef"><b>Definition:</b> IProfiler.h:53</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a7501a6f2e7959b283fd801ac6aeb0f8b"><div class="ttname"><a href="classrt_1_1IRuntime.html#a7501a6f2e7959b283fd801ac6aeb0f8b">rt::IRuntime::memcpyHostToDevice</a></div><div class="ttdeci">EventId memcpyHostToDevice(StreamId stream, const std::byte *h_src, std::byte *d_dst, size_t size, bool barrier=false, const CmaCopyFunction &amp;cmaCopyFunction=defaultCmaCopyFunction)</div><div class="ttdoc">Queues a memcpy operation from host memory to device memory. The device memory must be previously all...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a0ccd044349fb81c6c94eafa28b977c95"><div class="ttname"><a href="classrt_1_1IRuntime.html#a0ccd044349fb81c6c94eafa28b977c95">rt::IRuntime::getDevices</a></div><div class="ttdeci">std::vector&lt; DeviceId &gt; getDevices()</div><div class="ttdoc">Returns all devices.</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a3091bd0f4aa2efa99c93da9ea186226b"><div class="ttname"><a href="classrt_1_1IRuntime.html#a3091bd0f4aa2efa99c93da9ea186226b">rt::IRuntime::loadCode</a></div><div class="ttdeci">LoadCodeResult loadCode(StreamId stream, const std::byte *elf, size_t elf_size)</div><div class="ttdoc">Loads an elf into the device. The caller will provide a byte code containing the elf representation a...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a5e95aab372520fc3d5e0de092562452f"><div class="ttname"><a href="classrt_1_1IRuntime.html#a5e95aab372520fc3d5e0de092562452f">rt::IRuntime::kernelLaunch</a></div><div class="ttdeci">EventId kernelLaunch(StreamId stream, KernelId kernel, const std::byte *kernel_args, size_t kernel_args_size, uint64_t shire_mask, bool barrier=true, bool flushL3=false, std::optional&lt; UserTrace &gt; userTraceConfig=std::nullopt)</div><div class="ttdoc">Queues a execution work into a stream. The work is identified by the kernel handler,...</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a145044ba3d9ed62b320a296b0e1f143c"><div class="ttname"><a href="classrt_1_1IRuntime.html#a145044ba3d9ed62b320a296b0e1f143c">rt::IRuntime::getProfiler</a></div><div class="ttdeci">profiling::IProfilerRecorder * getProfiler() const</div><div class="ttdoc">Returns a pointer to the profiler interface; don't delete/free this pointer since this is owned by th...</div><div class="ttdef"><b>Definition:</b> IRuntime.h:279</div></div>
<div class="ttc" id="astructrt_1_1DeviceProperties_html"><div class="ttname"><a href="structrt_1_1DeviceProperties.html">rt::DeviceProperties</a></div><div class="ttdoc">This struct encodes device properties.</div><div class="ttdef"><b>Definition:</b> Types.h:210</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a51538d6474b88062aba71ff8d8c959a2"><div class="ttname"><a href="classrt_1_1IRuntime.html#a51538d6474b88062aba71ff8d8c959a2">rt::IRuntime::waitForEvent</a></div><div class="ttdeci">bool waitForEvent(EventId event, std::chrono::seconds timeout=std::chrono::hours(24))</div><div class="ttdoc">This will block the caller thread until the given event is dispatched or the timeout is reached....</div></div>
<div class="ttc" id="aclassrt_1_1IRuntime_html_a5f1038d3f71b63a7bd0d6f66c10647ff"><div class="ttname"><a href="classrt_1_1IRuntime.html#a5f1038d3f71b63a7bd0d6f66c10647ff">rt::IRuntime::memcpyDeviceToHost</a></div><div class="ttdeci">EventId memcpyDeviceToHost(StreamId stream, const std::byte *d_src, std::byte *h_dst, size_t size, bool barrier=true, const CmaCopyFunction &amp;cmaCopyFunction=defaultCmaCopyFunction)</div><div class="ttdoc">Queues a memcpy operation from device memory to host memory. The device memory must be a valid region...</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
